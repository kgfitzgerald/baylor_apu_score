name: Quick Quarto Test

# Trigger on PRs and pushes, but only to avoid slow gh-pages builds
on:
  push:
    branches:
      - main
  pull_request:

jobs:
  quick-test:
    runs-on: ubuntu-latest

    steps:
      # 1. Check out your repo
      - name: Check out repository
        uses: actions/checkout@v4

      # 2. Set up R 4.4
      - name: Set up R
        uses: r-lib/actions/setup-r@v2
        with:
          r-version: '4.4'

      # 3. Install only the packages you need for rendering
      - name: Install minimal R package dependencies
        uses: r-lib/actions/setup-r-dependencies@v2
        with:
          cache: true
          pak-args: --no-suggests
          packages: |
            tidyverse
            fs
            glue
            lubridate
            SimplyAgree
            DescTools
            fmsb
            scales
            janitor
            psych
            here
            irr
            magrittr
            flextable
            webexercises
            parameters
            factoextra
            NbClust
            cluster
            formatR
            ClusterR
            mclust
            easystats
            knitr
            kableExtra
            condformat
            formattable
            rectablefmtr
            plotly

      # 4. Install Quarto (required to render)
      - name: Set up Quarto
        uses: quarto-dev/quarto-actions/setup@v2

      # 5. Quick render test (no deploy, no heavy files)
      - name: Render only failing pages
        run: |
          # Render only the page that was failing
          quarto render basketball/Clustering/index.qmd
          # You can add more individual pages if needed
          # quarto render baseball/mlb_prime_age/index.qmd
